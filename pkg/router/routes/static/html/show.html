{{ define "show" }}
<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap -->
    <link 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" 
        rel="stylesheet" 
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" 
        crossorigin="anonymous"
    >

    <!-- Custom CSS -->
    <link
        rel="stylesheet"
        type="text/css"
        href="/css/base.css"
    >

    <title>{{ .Title }}</title>
</head>

<body>
    <div class="parent" style="width:100%;">
        <h1>Battery history</h1>
        <div id="chart" style="width:100%; height:300px;"></div>
    </div>

    <Script src="https://cdn.jsdelivr.net/npm/echarts@5.3.0/dist/echarts.min.js"></Script>

    <Script type="text/javascript">
        var chart = echarts.init(document.getElementById('chart'), "dark");
        var json = "{{ .Data }}";
        var data = JSON.parse(json);
        var series = {
            data: [],
            type: 'line',
            smooth: false,
            symbol: "none",
            zlevel: 1,
            z: 1
        }
        Object.values(data.Batteries).forEach((battery) => {
            series.data.push([battery.Time, battery.Load])
        });

        var option = {
            backgroundColor: '#343a40',
            tooltip: {
                trigger: "axis",
                position: function (pt) {
                    return [pt[0], "10%"];
                },
                valueFormatter: (value) => {return value + "%"}
            },
            grid: {
                left: '10%',
                right: '5%',
            },
            xAxis: {
                type: 'time',
                splitNumber: 3,
            },
            yAxis: {
                type: 'value',
                axisLabel: {
                    formatter: function (value, index) {
                        return value + "%"
                    }
                }
            },
            dataZoom: [
                {
                    type: "slider",
                    start: 0,
                    end: 100
                },
                {
                    start: 0,
                    end: 100,
                }
            ],
            series: [
                series
            ]
        };

        option && chart.setOption(option);

        window.onload = function () {
            if (window.screen.width < 600) {
                chart.resize({
                    width: document.getElementById("chart").width,
                    height: document.getElementById("chart").width
                });
            }
        }

        window.onresize = function () {
            chart.resize();
            if (window.screen.width < 600) {
                chart.resize({
                    width: document.getElementById("chart").width,
                    height: document.getElementById("chart").width
                });
            }
        };
    </Script>

    <!-- Bootstrap -->
    <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" 
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" 
        crossorigin="anonymous"
    ></script>
</body>
</html>
{{ end }}